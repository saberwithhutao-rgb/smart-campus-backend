# 修改为以下内容：
spring:
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:smart_campus}
    username: ${DB_USER:postgres}
    password: ${DB_PASSWORD}
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        format_sql: false

  mail:
    host: ${MAIL_HOST:gz-smtp.qcloudmail.com}
    port: ${MAIL_PORT:465}
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    protocol: smtps
    properties:
      mail:
        smtp:
          auth: true
          ssl:
            enable: true  # 465端口必须启用SSL
          connectiontimeout: 10000
          timeout: 10000
          writetimeout: 10000

  data:
    redis:
      host: localhost
      port: 6379
      timeout: 5000
      database: 1  # 使用1号库存储AI缓存

server:
  port: ${SERVER_PORT:8080}

logging:
  level:
    root: ${LOG_LEVEL:INFO}
    com.smartcampus: DEBUG
  file:
    name: /var/log/smart-campus/app.log
  logback:
    rollingpolicy:
      max-file-size: 10MB
      max-history: 30
jwt:
  secret: your-strong-secret-key-here-must-be-changed-in-production
  expiration: 86400000  # 24小时，单位毫秒

# 在现有配置中添加AI相关配置
ai:
  qianwen:
    api-key: sk-131e010e2b4a4fd3a7c41ef3e3ae10d8
    api-url: https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions
    timeout: 30000

  embedding:
    model: text-embedding-v2
    chunk-size: 500
    chunk-overlap: 50

  rag:
    top-k: 3  # 检索最相关的3个片段
    similarity-threshold: 0.7  # 相似度阈值

  task:
    timeout: 300000  # 5分钟超时
    max-concurrent: 10
# 添加文件上传配置
file:
  upload:
    max-size: 50MB
    allowed-types: pdf,docx,txt,jpg,jpeg,png,mp3,wav,ppt,pptx
    storage:
      location: /opt/smart-campus/uploads




